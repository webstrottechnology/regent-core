(()=>{var t={15053(){function t(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||n(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i,a,s=[],d=!0,c=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;d=!1}else for(;!(d=(o=i.call(n)).done)&&(s.push(o.value),s.length!==e);d=!0);}catch(t){c=!0,r=t}finally{try{if(!d&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw r}}return s}}(t,e)||n(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){if(t){if("string"==typeof t)return o(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=Array(e);n<e;n++)o[n]=t[n];return o}var r={$container:null,sortableInstance:null,init:function(){var t=this;this.$container=$("#vb-shortcode-list"),this.render(),this.attachEvents(),this.initDragDrop(),VisualBuilderState.on("shortcode-added",function(){return t.render()}),VisualBuilderState.on("shortcode-deleted",function(){return t.render()}),VisualBuilderState.on("shortcode-updated",function(){return t.render()}),VisualBuilderState.on("shortcodes-reordered",function(){return t.render()}),VisualBuilderState.on("active-changed",function(e){return t.updateActiveState(e)})},render:function(){var t=this,e=VisualBuilderState.getAllShortcodes(),n=VisualBuilderState.getActiveShortcode(),o=n?n.id:null;if(0!==e.length){var r=window.visualBuilderData||{};$.ajax({url:r.renderItemsUrl,method:"POST",data:{_token:r.csrfToken,shortcodes:e,activeId:o},success:function(e){e.data&&e.data.html&&(t.$container.html(e.data.html),t.initDragDrop())}})}else this.$container.html('\n                <div class="text-center text-muted py-4">\n                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-lg" width="48" height="48" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" style="opacity: 0.3;">\n                        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>\n                        <path d="M3 4m0 3a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v10a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3z"></path>\n                        <path d="M10 16h-3a2 2 0 0 1 -2 -2v-10a2 2 0 0 1 2 -2h9a2 2 0 0 1 2 2v2"></path>\n                    </svg>\n                    <p>No shortcodes yet. Click "Add Shortcode" to get started.</p>\n                </div>\n            ')},renderItem:function(t,n){var o=VisualBuilderState.activeShortcode===t.id?"active":"",r="";t.attributes?r=Object.entries(t.attributes).slice(0,2).map(function(t){var n=e(t,2),o=n[0],r=n[1];return"".concat(o,": ").concat(r)}).join(", ")||t.name:r=t.name;return'\n            <div class="vb-shortcode-item '.concat(o,'" data-id="').concat(t.id,'">\n                <div class="vb-item-drag-handle">\n                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">\n                        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>\n                        <path d="M9 5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"></path>\n                        <path d="M9 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"></path>\n                        <path d="M9 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"></path>\n                        <path d="M15 5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"></path>\n                        <path d="M15 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"></path>\n                        <path d="M15 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"></path>\n                    </svg>\n                </div>\n                <div class="vb-item-icon">\n                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">\n                        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>\n                        <path d="M7 8l-4 4l4 4"></path>\n                        <path d="M17 8l4 4l-4 4"></path>\n                        <path d="M14 4l-4 16"></path>\n                    </svg>\n                </div>\n                <div class="vb-item-content">\n                    <h4 class="vb-item-name">').concat(this.escapeHtml(t.name),'</h4>\n                    <div class="vb-item-preview">').concat(this.escapeHtml(r),'</div>\n                </div>\n                <div class="vb-item-actions">\n                    <button type="button" class="btn btn-sm btn-ghost vb-delete-btn" data-id="').concat(t.id,'" title="Delete">\n                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">\n                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>\n                            <path d="M4 7l16 0"></path>\n                            <path d="M10 11l0 6"></path>\n                            <path d="M14 11l0 6"></path>\n                            <path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12"></path>\n                            <path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3"></path>\n                        </svg>\n                    </button>\n                </div>\n            </div>\n        ')},attachEvents:function(){var t=this;this.$container.on("click",".vb-delete-btn",function(e){e.preventDefault(),e.stopPropagation();var n=$(this).data("id");t.deleteShortcode(n)}),this.$container.on("click",".vb-shortcode-item",function(e){if(!$(e.target).hasClass("vb-delete-btn")&&!$(e.target).closest(".vb-delete-btn").length&&!$(e.target).closest(".vb-item-drag-handle").length){var n=$(this).data("id");t.openEditPanel(n)}}),this.$container.on("mouseenter",".vb-shortcode-item",function(t){var e=$(this).data("id");"undefined"!=typeof PreviewIframe&&PreviewIframe.isReady&&PreviewIframe.highlightShortcode(e)}),this.$container.on("mouseleave",".vb-shortcode-item",function(t){"undefined"!=typeof PreviewIframe&&PreviewIframe.isReady&&PreviewIframe.unhighlightShortcode()})},initDragDrop:function(){var t=this;this.sortableInstance&&this.sortableInstance.destroy(),"undefined"!=typeof Sortable&&this.$container[0]&&(this.sortableInstance=new Sortable(this.$container[0],{animation:150,handle:".vb-item-drag-handle",ghostClass:"sortable-ghost",dragClass:"sortable-drag",onEnd:function(e){t.handleReorder(e)}}))},handleReorder:function(e){var n=VisualBuilderState.getAllShortcodes(),o=n[e.oldIndex],r=t(n);r.splice(e.oldIndex,1),r.splice(e.newIndex,0,o),VisualBuilderState.reorderShortcodes(r),"undefined"!=typeof PreviewIframe&&PreviewIframe.reload()},openEditPanel:function(t){VisualBuilderState.setActive(t),$("#vb-edit-panel").removeClass("d-none").show(),"undefined"!=typeof ShortcodeEditPanel&&ShortcodeEditPanel.render(t),"undefined"!=typeof PreviewIframe&&PreviewIframe.highlightShortcode(t)},deleteShortcode:function(t){var e;if(t){var n=(null===(e=(window.visualBuilderData||{}).translations)||void 0===e?void 0:e.confirmDelete)||"Are you sure you want to delete this shortcode?";confirm(n)&&(VisualBuilderState.deleteShortcode(t),"undefined"!=typeof PreviewIframe&&PreviewIframe.reload())}},updateActiveState:function(t){this.$container.find(".vb-shortcode-item").removeClass("active"),t&&this.$container.find('.vb-shortcode-item[data-id="'.concat(t,'"]')).addClass("active")},escapeHtml:function(t){var e=document.createElement("div");return e.textContent=t,e.innerHTML}};window.ShortcodeList=r},16620(){var t={allowedOrigin:window.location.origin,sendToIframe:function(t,e,n){if(t&&t.contentWindow){var o={source:"visual-builder",type:e,payload:n||{}};try{t.contentWindow.postMessage(o,this.allowedOrigin)}catch(t){}}},listenToIframe:function(t){var e=this;window.addEventListener("message",function(n){n.origin===e.allowedOrigin&&n.data&&"visual-builder-preview"===n.data.source&&"function"==typeof t&&t(n.data.type,n.data.payload)})},sendToParent:function(t,e){if(window.parent!==window){var n={source:"visual-builder-preview",type:t,payload:e||{}};try{window.parent.postMessage(n,this.allowedOrigin)}catch(t){}}}};window.PostMessageUtil=t},45062(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var o={}.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?n(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=Array(e);n<e;n++)o[n]=t[n];return o}function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function r(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach(function(e){i(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function i(t,e,n){return(e=s(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,s(o.key),o)}}function s(e){var n=function(e,n){if("object"!=t(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var r=o.call(e,n||"default");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==t(n)?n:n+""}var d=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.$menu=null,this.iframe=null,this.targetId=null},n=[{key:"init",value:function(){var t=this;this.createMenu(),this.iframe=document.getElementById("vb-preview-iframe"),this.iframe&&(this.iframe.addEventListener("load",function(){t.attachListener()}),this.iframe.contentDocument&&"complete"===this.iframe.contentDocument.readyState&&this.attachListener()),$(document).on("click",function(){return t.hide()}),this.$menu.on("click",".dropdown-item",function(e){e.preventDefault();var n=$(e.currentTarget).data("action");t.handleAction(n),t.hide()})}},{key:"createMenu",value:function(){$("body").append('\n            <div id="vb-context-menu" class="dropdown-menu dropdown-menu-end position-fixed" style="z-index: 9999; display: none;">\n                <a class="dropdown-item" href="#" data-action="edit">\n                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-pencil me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" /><line x1="13.5" y1="6.5" x2="17.5" y2="10.5" /></svg>\n                    Edit\n                </a>\n                <a class="dropdown-item" href="#" data-action="duplicate">\n                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><rect x="8" y="8" width="12" height="12" rx="2" /><path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2" /></svg>\n                    Duplicate\n                </a>\n                <div class="dropdown-divider"></div>\n                <a class="dropdown-item" href="#" data-action="copy-style">\n                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brush me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 21v-4a4 4 0 1 1 4 4h-4" /><path d="M21 3a16 16 0 0 0 -12.8 10.2" /><path d="M21 3a16 16 0 0 1 -10.2 12.8" /><path d="M10.6 9a9 9 0 0 1 4.4 4.4" /></svg>\n                    Copy Style\n                </a>\n                <a class="dropdown-item" href="#" data-action="paste-style" id="vb-ctx-paste-style" style="display:none">\n                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-bucket me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M19 11v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2" /><path d="M13 13l9 -9" /><path d="M13 13l-9 9" /><path d="M13 13l9 9" /><path d="M13 13l-9 -9" /></svg>\n                    Paste Style\n                </a>\n                <div class="dropdown-divider"></div>\n                <a class="dropdown-item" href="#" data-action="move-up">\n                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrow-up me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="12" y1="5" x2="12" y2="19" /><line x1="18" y1="11" x2="12" y2="5" /><line x1="6" y1="11" x2="12" y2="5" /></svg>\n                    Move Up\n                </a>\n                <a class="dropdown-item" href="#" data-action="move-down">\n                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrow-down me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="12" y1="5" x2="12" y2="19" /><line x1="18" y1="13" x2="12" y2="19" /><line x1="6" y1="13" x2="12" y2="19" /></svg>\n                    Move Down\n                </a>\n                <div class="dropdown-divider"></div>\n                <a class="dropdown-item text-danger" href="#" data-action="delete">\n                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-trash me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="4" y1="7" x2="20" y2="7" /><line x1="10" y1="11" x2="10" y2="17" /><line x1="14" y1="11" x2="14" y2="17" /><path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12" /><path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3" /></svg>\n                    Delete\n                </a>\n            </div>\n        '),this.$menu=$("#vb-context-menu")}},{key:"attachListener",value:function(){var t=this,e=this.iframe.contentDocument;e&&(e.body.addEventListener("contextmenu",function(e){var n=e.target.closest("[data-shortcode-id]");if(n){e.preventDefault(),t.targetId=n.getAttribute("data-shortcode-id");var o=t.$menu.find("#vb-ctx-paste-style");if(window.vbClipboard&&"style"===window.vbClipboard.type){var r=VisualBuilderState.getShortcode(t.targetId);r&&r.name===window.vbClipboard.shortcodeName?o.show():o.hide()}else o.hide();var i=t.iframe.getBoundingClientRect(),a=i.left+e.clientX,s=i.top+e.clientY;t.show(a,s)}else t.hide()}),e.body.addEventListener("click",function(e){t.hide()}))}},{key:"show",value:function(t,e){this.$menu.css({top:e+"px",left:t+"px",display:"block"});var n=this.$menu.outerWidth(),o=this.$menu.outerHeight(),r=$(window).width(),i=$(window).height(),a=t;t+n>r&&(a=r-n-10);var s=e;e+o>i&&(s=i-o-10),this.$menu.css({top:s+"px",left:a+"px"})}},{key:"hide",value:function(){this.$menu.hide()}},{key:"handleAction",value:function(t){var n=this.targetId;if(n){var o=VisualBuilderState.getAllShortcodes(),i=o.findIndex(function(t){return t.id===n});if(-1!==i){switch(t){case"edit":VisualBuilderState.setActive(n);break;case"duplicate":var a=JSON.parse(JSON.stringify(o[i]));a.id=VisualBuilderState.generateId(),VisualBuilderState.addShortcode(a,i+1);break;case"copy-style":window.vbClipboard={type:"style",shortcodeName:o[i].name,attributes:JSON.parse(JSON.stringify(o[i].attributes||{}))},"undefined"!=typeof Botble&&Botble.showSuccess&&Botble.showSuccess("Style copied!");break;case"paste-style":if(window.vbClipboard&&"style"===window.vbClipboard.type){var s=r(r({},o[i].attributes),window.vbClipboard.attributes);VisualBuilderState.updateShortcode(n,{attributes:s}),"undefined"!=typeof PreviewIframe&&PreviewIframe.updateShortcode(n,{attributes:s}),"undefined"!=typeof Botble&&Botble.showSuccess&&Botble.showSuccess("Style pasted!")}break;case"delete":confirm(window.visualBuilderData.translations.confirmDelete)&&VisualBuilderState.deleteShortcode(n);break;case"move-up":if(i>0){var d=e(o),c=d[i];d[i]=d[i-1],d[i-1]=c,VisualBuilderState.reorderShortcodes(d)}break;case"move-down":if(i<o.length-1){var l=e(o),u=l[i];l[i]=l[i+1],l[i+1]=u,VisualBuilderState.reorderShortcodes(l)}}["duplicate","delete","move-up","move-down"].includes(t)&&("undefined"!=typeof PreviewIframe&&setTimeout(function(){return PreviewIframe.reload()},50),"undefined"!=typeof ShortcodeList&&ShortcodeList.render())}}}}],n&&a(t.prototype,n),o&&a(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,o}();window.ContextMenu=new d},51676(){function t(t,n){var o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=function(t,n){if(t){if("string"==typeof t)return e(t,n);var o={}.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?e(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){o&&(t=o);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,d=!1;return{s:function(){o=o.call(t)},n:function(){var t=o.next();return s=t.done,t},e:function(t){d=!0,a=t},f:function(){try{s||null==o.return||o.return()}finally{if(d)throw a}}}}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=Array(e);n<e;n++)o[n]=t[n];return o}var n={$iframe:null,$container:null,$loading:null,$error:null,$preview:null,iframe:null,isReady:!1,deviceMode:"desktop",init:function(){var t=this;this.$iframe=$("#vb-preview-iframe"),this.$container=$("#vb-preview-frame-container"),this.$loading=$("#vb-preview-loading"),this.$error=$("#vb-preview-error"),this.$preview=$("#vb-preview"),this.iframe=this.$iframe[0],this.$iframe.on("load",function(){t.handleLoad()}),this.$iframe.on("error",function(){t.showError("Failed to load preview")}),"undefined"!=typeof PostMessageUtil&&PostMessageUtil.listenToIframe(function(e,n){t.handleMessage(e,n)}),this.setDeviceMode("desktop")},handleLoad:function(){var t=this;this.isReady=!0,this.hideLoading(),this.$preview.addClass("loaded"),setTimeout(function(){t.injectEditIcons(),t.enableInlineEditing(),t.enableSorting(),t.attachLazyLoadListener()},1e3)},attachLazyLoadListener:function(){if(this.iframe&&this.iframe.contentDocument){var t=this.iframe.contentDocument;t.addEventListener("shortcode.loaded",function(e){setTimeout(function(){"undefined"!=typeof EditIconInjector&&EditIconInjector.inject(t)},100)})}},enableInlineEditing:function(){if(this.iframe&&this.iframe.contentDocument){var e=this.iframe.contentDocument;this._inlineCtx&&(e.body.removeEventListener("click",this._inlineCtx),e.body.removeEventListener("input",this._inlineInputCtx)),this._inlineCtx=function(e){var n=$("#vb-edit-form");if(n.length){var o=e.target,r=function(t){return t?t.replace(/[\s\u00A0]+/g," ").trim().replace(/['""]/g,"'").replace(/[""]/g,'"'):""};if("IMG"===o.tagName){var i=o.getAttribute("src");if(!i)return;var a=i.replace(window.location.origin,""),s=n.find('input[type="hidden"], input[type="text"]').filter(function(t,e){return function(t){if(!t)return!1;var e=decodeURIComponent(t),n=decodeURIComponent(i),o=decodeURIComponent(a);return t.includes(a)||i.includes(t)||e===o||n.endsWith(e)}($(e).val())}).first();if(s.length){e.preventDefault(),e.stopPropagation();var d=s.closest(".image-box").find(".btn_gallery");return void(d.length&&d.trigger("click"))}}if(function(e){if(0===e.children.length)return!0;var n,o=t(e.childNodes);try{for(o.s();!(n=o.n()).done;){var r=n.value;if(3!==r.nodeType&&"BR"!==r.tagName)return!1}}catch(t){o.e(t)}finally{o.f()}return!0}(o)&&o.textContent.trim().length>0){var c=r(o.innerText||o.textContent),l=n.find('input[type="text"], input[type="number"], textarea').filter(function(t,e){var n=$(e).val();return n&&n.includes("<")&&(n=n.replace(/<[^>]+>/g," ")),r(n)===c}).first();if(l.length){e.preventDefault(),e.stopPropagation(),o.contentEditable=!0,o.focus(),l.addClass("vb-bound-input"),l.css({"border-color":"#206bc4","box-shadow":"0 0 0 2px rgba(32, 107, 196, 0.25)",transition:"all 0.2s ease"}),"function"==typeof l[0].scrollIntoView&&l[0].scrollIntoView({behavior:"smooth",block:"center"});var u=function(){l.val(o.innerText)},h=function(){o.contentEditable=!1,l.removeClass("vb-bound-input"),l.css({"border-color":"","box-shadow":"",transition:""}),o.removeEventListener("input",u),o.removeEventListener("blur",h),o.removeEventListener("keydown",f),l.trigger("change")},f=function(t){"Enter"===t.key&&(t.preventDefault(),o.blur())};o.addEventListener("input",u),o.addEventListener("blur",h),o.addEventListener("keydown",f)}}}},e.body.addEventListener("click",this._inlineCtx)}},enableSorting:function(){var t=this;if(this.iframe&&this.iframe.contentDocument){var e=this.iframe.contentDocument;if(e.getElementById("vb-sortable-script"))this.initSortable();else{var n=e.createElement("script");n.id="vb-sortable-script",n.src="/vendor/core/core/base/libraries/sortable/sortable.min.js",n.onload=function(){return t.initSortable()},e.head.appendChild(n)}}},initSortable:function(){var t=this,e=this.iframe.contentDocument;if(e&&e.defaultView.Sortable){var n=new Set;e.querySelectorAll("[data-shortcode-id]").forEach(function(t){t.parentElement&&n.add(t.parentElement)}),n.forEach(function(n){n._sortable||(n._sortable=new e.defaultView.Sortable(n,{animation:150,handle:"[data-shortcode-id]",filter:"[contenteditable]",preventOnFilter:!1,onEnd:function(e){t.handleSort(e)}}))})}},handleSort:function(t){t.item;if(t.newIndex!==t.oldIndex){var e=this.iframe.contentDocument,n=[];e.querySelectorAll("[data-shortcode-id]").forEach(function(t){n.push(t.getAttribute("data-shortcode-id"))}),VisualBuilderState.reorderShortcodesByIds(n)}},handleMessage:function(t,e){switch(t){case"ready":this.handleLoad();break;case"edit-shortcode":e&&e.id&&this.handleEditRequest(e.id);break;case"delete-shortcode":e&&e.id&&this.handleDeleteRequest(e.id)}},handleEditRequest:function(t){"undefined"!=typeof ShortcodeList&&ShortcodeList.openEditPanel(t)},handleDeleteRequest:function(t){"undefined"!=typeof ShortcodeList&&ShortcodeList.deleteShortcode(t)},injectEditIcons:function(){if(this.iframe&&this.iframe.contentDocument)try{var t=this.iframe.contentDocument||this.iframe.contentWindow.document;"undefined"!=typeof EditIconInjector&&EditIconInjector.inject(t),this.injectEditIconStyles(t)}catch(t){}},injectEditIconStyles:function(t){if(!t.getElementById("vb-edit-icon-styles")){var e=t.createElement("style");e.id="vb-edit-icon-styles",e.textContent="\n            .vb-shortcode-block {\n                position: relative !important;\n                min-height: 20px;\n                transition: all 0.2s ease;\n            }\n\n            .vb-shortcode-toolbar {\n                position: absolute;\n                top: 10px;\n                right: 10px;\n                z-index: 9999;\n                display: flex;\n                gap: 4px;\n                opacity: 0;\n                transition: all 0.2s ease;\n                pointer-events: none;\n            }\n\n            .vb-shortcode-block:hover .vb-shortcode-toolbar,\n            .vb-shortcode-block.vb-active .vb-shortcode-toolbar {\n                opacity: 1;\n                pointer-events: all;\n            }\n\n            .vb-toolbar-btn {\n                width: 32px;\n                height: 32px;\n                border: none;\n                border-radius: 6px;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                cursor: pointer;\n                transition: all 0.2s ease;\n                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);\n                font-size: 16px;\n            }\n\n            .vb-toolbar-btn i,\n            .vb-toolbar-btn svg {\n                color: #fff;\n                stroke: #fff;\n                font-size: 16px;\n                line-height: 1;\n            }\n\n            .vb-toolbar-btn.vb-edit-btn {\n                background: #206bc4;\n            }\n\n            .vb-toolbar-btn.vb-edit-btn:hover {\n                background: #1a5ba7;\n                transform: scale(1.05);\n                box-shadow: 0 4px 12px rgba(32, 107, 196, 0.3);\n            }\n\n            .vb-toolbar-btn.vb-delete-btn {\n                background: #d63939;\n            }\n\n            .vb-toolbar-btn.vb-delete-btn:hover {\n                background: #c72e2e;\n                transform: scale(1.05);\n                box-shadow: 0 4px 12px rgba(214, 57, 57, 0.3);\n            }\n\n            .vb-shortcode-block:hover {\n                outline: 2px dashed #206bc4;\n                outline-offset: 2px;\n            }\n\n            .vb-shortcode-block.vb-active {\n                outline: 2px solid #206bc4 !important;\n                outline-offset: 2px;\n                background: rgba(32, 107, 196, 0.05);\n            }\n\n            .vb-shortcode-toolbar * {\n                box-sizing: border-box;\n            }\n        ",t.head.appendChild(e)}},reload:function(){this.isReady=!1,this.showLoading(),this.$preview.removeClass("loaded error");var t=VisualBuilderState.getAllShortcodes(),e=window.visualBuilderData||{},n=e.previewUrl+(e.previewUrl.includes("?")?"&":"?")+"visual_builder=1",o=$("<form>",{method:"POST",action:n,target:"vb-preview-iframe",style:"display: none;"});o.append($("<input>",{type:"hidden",name:"_token",value:e.csrfToken})),o.append($("<input>",{type:"hidden",name:"shortcodes",value:JSON.stringify(t)})),o.appendTo("body").submit().remove()},setDeviceMode:function(t){this.deviceMode=t,this.$container.removeClass("device-desktop device-tablet device-mobile"),this.$container.addClass("device-"+t)},highlightShortcode:function(t){if(this.iframe&&this.iframe.contentDocument)try{var e=this.iframe.contentDocument||this.iframe.contentWindow.document;"undefined"!=typeof EditIconInjector&&EditIconInjector.highlight(e,t)}catch(t){}},unhighlightShortcode:function(){if(this.iframe&&this.iframe.contentDocument)try{var t=this.iframe.contentDocument||this.iframe.contentWindow.document;"undefined"!=typeof EditIconInjector&&EditIconInjector.unhighlight(t)}catch(t){}},updateShortcode:function(t,e){var n=this,o=VisualBuilderState.getShortcode(t);if(o){var r=window.visualBuilderData||{},i=e&&e.attributes?e.attributes:o.attributes,a={};i&&Object.keys(i).forEach(function(t){var e=i[t];Array.isArray(e)&&(e=e.join(",")),a[t]=e}),$.ajax({url:"/ajax/render-ui-blocks",method:"POST",data:{_token:r.csrfToken,name:o.name,attributes:a},success:function(e){e&&e.data&&n.replaceShortcodeContent(t,e.data)},error:function(t,e,o){console.error("[VB] Failed to render shortcode:",o,t.responseText),n.reload()}})}else console.warn("[VB] Shortcode not found for update:",t)},replaceShortcodeContent:function(t,e){if(this.iframe&&this.iframe.contentDocument)try{var n=this.iframe.contentDocument||this.iframe.contentWindow.document,o=n.querySelector('[data-shortcode-id="'.concat(t,'"]'));if(o){var r=n.createElement("div");r.innerHTML=e;var i=r.firstElementChild;if(i){i.setAttribute("data-shortcode-id",t),i.setAttribute("data-shortcode-name",o.getAttribute("data-shortcode-name")||"");try{o.parentNode.replaceChild(i,o)}catch(t){console.error("[VB] Error replacing child:",t)}"undefined"!=typeof EditIconInjector&&EditIconInjector.injectIcon(i,n),VisualBuilderState.activeShortcode===t&&i.classList.add("vb-active"),n.defaultView&&"function"==typeof n.defaultView.reloadInfiniaTheme&&setTimeout(function(){try{n.defaultView.reloadInfiniaTheme()}catch(t){console.error("[VB] Error executing reloadInfiniaTheme:",t)}},100)}else o.innerHTML=e}else console.warn("[VB] Shortcode element not found in iframe, reloading"),this.reload()}catch(t){console.error("[VB] Error replacing shortcode content:",t),this.reload()}},showLoading:function(){this.$loading.show(),this.$error.hide(),this.$container.hide()},hideLoading:function(){this.$loading.hide(),this.$container.show()},showError:function(t){this.isReady=!1,this.$loading.hide(),this.$container.hide(),this.$error.show(),this.$preview.addClass("error"),t&&$("#vb-error-message").text(t)}};window.PreviewIframe=n},56976(){!function(t){"use strict";var e={config:{},modules:{},draftCheckPerformed:!1,init:function(){this.config=window.visualBuilderData||{},VisualBuilderState.init(this.config.shortcodes),this.initHeader(),this.initUndoRedo(),this.initSidebar(),this.initPreview(),this.initAutoSave(),this.initUnsavedWarning(),"undefined"!=typeof ContextMenu&&ContextMenu.init()},initHeader:function(){var e=this;t("#vb-save-btn").on("click",function(){e.save()}),t("#vb-close-btn").on("click",function(t){if(VisualBuilderState.hasChanges){if(!confirm(e.config.translations.unsavedChanges))return t.preventDefault(),!1;VisualBuilderState.clearChanges()}}),t('#vb-device-modes input[type="radio"]').on("change",function(){if(this.checked){var e=t(this).data("device");VisualBuilderState.setDeviceMode(e)}}),VisualBuilderState.on("has-changes",function(e){e?t("#vb-unsaved-indicator").show():t("#vb-unsaved-indicator").hide()}),VisualBuilderState.on("saving-changed",function(n){var o=t("#vb-save-btn"),r='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icon-tabler-device-floppy"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2" /><path d="M12 14m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" /><path d="M14 4l0 4l-6 0l0 -4" /></svg>';n?(o.prop("disabled",!0),o.html('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icon-tabler-loader animate-spin"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 6l0 -3" /><path d="M16.25 7.75l2.15 -2.15" /><path d="M18 12l3 0" /><path d="M16.25 16.25l2.15 2.15" /><path d="M12 18l0 3" /><path d="M7.75 16.25l-2.15 2.15" /><path d="M6 12l-3 0" /><path d="M7.75 7.75l-2.15 -2.15" /></svg> <span class="d-none d-sm-inline">'+e.config.translations.saving+"</span>")):(o.prop("disabled",!1),o.html(r+' <span class="d-none d-sm-inline">'+e.config.translations.saved+"</span>"),setTimeout(function(){VisualBuilderState.isSaving||o.html(r+' <span class="d-none d-sm-inline">'+(e.config.translations.save||"Save")+"</span>")},2e3))})},initUndoRedo:function(){t("#vb-undo-btn").on("click",function(){VisualBuilderState.undo()}),t("#vb-redo-btn").on("click",function(){VisualBuilderState.redo()}),VisualBuilderState.on("history-changed",function(e){t("#vb-undo-btn").prop("disabled",!e.canUndo),t("#vb-redo-btn").prop("disabled",!e.canRedo)}),VisualBuilderState.on("state-restored",function(){"undefined"!=typeof ShortcodeList&&ShortcodeList.render(),"undefined"!=typeof PreviewIframe&&PreviewIframe.reload(),VisualBuilderState.clearActive(),t("#vb-edit-panel").addClass("d-none").hide()}),t(document).on("keydown",function(t){(t.metaKey||t.ctrlKey)&&("z"===t.key?(t.preventDefault(),t.shiftKey?VisualBuilderState.redo():VisualBuilderState.undo()):"y"===t.key&&(t.preventDefault(),VisualBuilderState.redo()))})},initSidebar:function(){"undefined"!=typeof ShortcodeList&&ShortcodeList.init(),"undefined"!=typeof ShortcodeEditPanel&&ShortcodeEditPanel.init(),"undefined"!=typeof AddShortcodeModal&&AddShortcodeModal.init(),t("#vb-back-btn, #vb-close-panel-btn").on("click",function(){t("#vb-edit-panel").addClass("d-none").hide(),VisualBuilderState.clearActive()}),t("#vb-add-shortcode-btn").on("click",function(){"undefined"!=typeof AddShortcodeModal&&AddShortcodeModal.show()}),VisualBuilderState.on("active-changed",function(e){e?(t("#vb-edit-panel").removeClass("d-none").show(),"undefined"!=typeof ShortcodeEditPanel&&ShortcodeEditPanel.render(e)):t("#vb-edit-panel").addClass("d-none").hide()})},initPreview:function(){"undefined"!=typeof PreviewIframe&&(PreviewIframe.init(),PreviewIframe.reload()),t("#vb-reload-preview-btn").on("click",function(){"undefined"!=typeof PreviewIframe&&PreviewIframe.reload()}),VisualBuilderState.on("device-mode-changed",function(t){"undefined"!=typeof PreviewIframe&&PreviewIframe.setDeviceMode(t)})},save:function(){var e=this;VisualBuilderState.setSaving(!0);var n="";"undefined"!=typeof ShortcodeSerializer&&(n=ShortcodeSerializer.serialize(VisualBuilderState.getAllShortcodes())),t.ajax({url:this.config.saveUrl,method:"POST",data:{_token:this.config.csrfToken,content:n},success:function(t){VisualBuilderState.setSaving(!1),VisualBuilderState.clearChanges(),localStorage.removeItem("vb_draft_"+e.config.pageId),"undefined"!=typeof Botble&&Botble.showSuccess?Botble.showSuccess(e.config.translations.saved):alert(e.config.translations.saved)},error:function(t){VisualBuilderState.setSaving(!1);var n=e.config.translations.error;t.responseJSON&&t.responseJSON.message&&(n=t.responseJSON.message),"undefined"!=typeof Botble&&Botble.showError?Botble.showError(n):alert(n)}})},initAutoSave:function(){var t=this,e=null;VisualBuilderState.on("has-changes",function(n){n&&!e?e=setInterval(function(){t.autoSave()},3e4):!n&&e&&(clearInterval(e),e=null)}),this.checkDraft()},autoSave:function(){var t={timestamp:Date.now(),shortcodes:VisualBuilderState.getAllShortcodes()};try{localStorage.setItem("vb_draft_"+this.config.pageId,JSON.stringify(t))}catch(t){}},checkDraft:function(){if(!this.draftCheckPerformed){this.draftCheckPerformed=!0;var t="vb_draft_"+this.config.pageId,e=localStorage.getItem(t);if(e)try{var n=JSON.parse(e),o=new Date(n.timestamp);confirm("Restore unsaved changes from "+o.toLocaleString()+"?")?(VisualBuilderState.init(n.shortcodes),VisualBuilderState.markChanged(),"undefined"!=typeof ShortcodeList&&ShortcodeList.render(),"undefined"!=typeof PreviewIframe&&PreviewIframe.reload()):localStorage.removeItem(t)}catch(e){localStorage.removeItem(t)}}},initUnsavedWarning:function(){window.addEventListener("beforeunload",function(t){if(VisualBuilderState.hasChanges)return t.preventDefault(),t.returnValue="",""})}};window.VisualBuilderApp=e}(jQuery)},58763(){function t(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||n(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i,a,s=[],d=!0,c=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;d=!1}else for(;!(d=(o=i.call(n)).done)&&(s.push(o.value),s.length!==e);d=!0);}catch(t){c=!0,r=t}finally{try{if(!d&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw r}}return s}}(t,e)||n(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){if(t){if("string"==typeof t)return o(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=Array(e);n<e;n++)o[n]=t[n];return o}function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}var i={serialize:function(t){var e=this;return Array.isArray(t)?t.map(function(t){return e.serializeOne(t)}).join("\n\n"):""},serializeOne:function(t){if(!t||!t.name)return"";var n="["+t.name;if(t.attributes&&"object"===r(t.attributes))for(var o=0,i=Object.entries(t.attributes);o<i.length;o++){var a=e(i[o],2),s=a[0],d=a[1];if(null!=d&&""!==d){var c=this.escapeAttribute(d);n+=" ".concat(s,'="').concat(c,'"')}}return n+="]",t.content&&(n+=t.content),n+="[/"+t.name+"]"},escapeAttribute:function(t){return"string"!=typeof t&&(t=String(t)),t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')},parse:function(e){var n=this;return t(e.matchAll(/\[(\w+)([^\]]*?)(?:\s*\/\]|\]([^]*?)\[\/\1\])/g)).map(function(t,e){var o=t[1],r=t[2]||"",i=t[3]||"",a=t[0].endsWith("/]");return{id:"sc_parsed_"+Date.now()+"_"+e,name:o,attributes:n.parseAttributes(r),content:i,isSelfClosing:a,position:e,raw:t[0]}})},parseAttributes:function(t){var e={};if(!t||!t.trim())return e;for(var n,o=/(\w+)\s*=\s*(?:"([^"]*)"|'([^']*)')/g;null!==(n=o.exec(t));){var r=n[1],i=n[2]||n[3]||"";e[r]=i}return e},validate:function(e){var n=[];(e.match(/\[/g)||[]).length!==(e.match(/\]/g)||[]).length&&n.push("Mismatched brackets");var o=t(e.matchAll(/\[(\w+)(?:[^\]]*?)(?:\s*\/\]|\]([^]*?)\[\/\1\])/g)),r=e.match(/\[\w+/g)||[];return 2*o.length<r.length&&n.push("Possible unclosed shortcodes"),{valid:0===n.length,errors:n}}};window.ShortcodeSerializer=i},61696(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function n(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?e(Object(r),!0).forEach(function(e){o(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function o(e,n,o){return(n=function(e){var n=function(e,n){if("object"!=t(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var r=o.call(e,n||"default");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==t(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}var r={$listModal:null,$formModal:null,listModalInstance:null,formModalInstance:null,selectedShortcode:null,init:function(){this.$listModal=$("#vb-shortcode-list-modal"),this.$formModal=$("#vb-shortcode-modal"),"undefined"!=typeof bootstrap&&bootstrap.Modal&&(this.listModalInstance=new bootstrap.Modal(this.$listModal[0]),this.formModalInstance=new bootstrap.Modal(this.$formModal[0])),this.attachEvents()},attachEvents:function(){var t=this;$(document).on("change",'[data-bb-toggle="shortcode-item-radio"]',function(){$('[data-bb-toggle="vb-shortcode-use"]').prop("disabled",!1).removeClass("disabled")}),$(document).on("dblclick",'[data-bb-toggle="vb-shortcode-select"]',function(e){var n=$(e.currentTarget);t.triggerShortcode(n)}),$('[data-bb-toggle="vb-shortcode-use"]').on("click",function(){var e=t.$listModal.find(".shortcode-item-input:checked").closest(".shortcode-item-wrapper");t.triggerShortcode(e),$('[data-bb-toggle="shortcode-item-radio"]').prop("checked",!1),$('[data-bb-toggle="vb-shortcode-use"]').prop("disabled",!0).addClass("disabled")}),$(document).on("click",'[data-bb-toggle="vb-shortcode-button-use"]',function(e){e.stopPropagation();var n=$(e.currentTarget).closest(".shortcode-item-wrapper");t.triggerShortcode(n)}),$('[data-bb-toggle="vb-shortcode-add-single"]').on("click",function(e){e.preventDefault(),t.insertShortcode()}),this.$formModal.on("show.bs.modal",function(){t.listModalInstance&&t.listModalInstance.hide(),$('[data-bb-toggle="shortcode-item-radio"]').prop("checked",!1),$('[data-bb-toggle="vb-shortcode-use"]').prop("disabled",!0).addClass("disabled")}),$('[data-bb-toggle="shortcode-clear-search"]').on("click",function(){t.$listModal.find('input[name="search"]').val(""),t.filterShortcodes("")}),t.$listModal.find('input[name="search"]').on("input",function(){t.filterShortcodes($(this).val())})},show:function(){this.listModalInstance?this.listModalInstance.show():this.$listModal.modal("show")},triggerShortcode:function(t){this.loadShortcodeConfig({href:t.data("url"),key:t.data("key"),name:t.data("name"),description:t.data("description")})},loadShortcodeConfig:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.href,o=t.key,r=t.name,i=t.description,a=void 0===i?null:i,s=t.data,d=void 0===s?{}:s,c=t.update,l=void 0!==c&&c;this.selectedShortcode={key:o,name:r,description:a},$(".shortcode-admin-config").html("");var u=$('.shortcode-modal button[data-bb-toggle="vb-shortcode-add-single"]');u.text(u.data(l?"update-text":"add-text")),$(".shortcode-modal .modal-title").text(r),this.formModalInstance?this.formModalInstance.show():this.$formModal.modal("show");var h=this.$formModal.find(".modal-content");"undefined"!=typeof Botble&&Botble.showLoading&&Botble.showLoading(h),$.ajax({url:e,method:"POST",dataType:"json",data:n({_token:(window.visualBuilderData||{}).csrfToken},d),success:function(t){$(".shortcode-data-form").trigger("reset"),$(".shortcode-input-key").val(o),$(".shortcode-admin-config").html(t.data),"undefined"!=typeof Botble&&(Botble.hideLoading(h),Botble.initResources(),Botble.initMediaIntegrate(),Botble.initFieldCollapse())},error:function(){"undefined"!=typeof Botble&&(Botble.hideLoading(h),Botble.showError("Failed to load shortcode configuration"))}})},insertShortcode:function(){if(this.selectedShortcode){var t=$(".shortcode-modal").find(".shortcode-data-form"),e=t.serializeObject(),n={},o="";$.each(e,function(e,r){"content"===t.find('*[name="'+e+'"]').data("shortcode-attribute")?o=r:r&&(e=e.replace("[]",""),n[e]=r)});var r={name:this.selectedShortcode.key,attributes:n,content:o||"",isSelfClosing:!o};VisualBuilderState.addShortcode(r),"undefined"!=typeof PreviewIframe&&PreviewIframe.reload(),this.formModalInstance?this.formModalInstance.hide():this.$formModal.modal("hide")}},filterShortcodes:function(t){var e=t.toLowerCase(),n=this.$listModal.find(".shortcode-item-wrapper"),o=0;n.each(function(){var t=$(this),n=t.data("name").toLowerCase(),r=(t.data("description")||"").toLowerCase();n.includes(e)||r.includes(e)?(t.closest(".col-xl-3").show(),o++):t.closest(".col-xl-3").hide()}),0===o?(this.$listModal.find(".shortcode-empty").show(),this.$listModal.find(".shortcode-list").hide()):(this.$listModal.find(".shortcode-empty").hide(),this.$listModal.find(".shortcode-list").show())}};$.fn.serializeObject=function(){var t={},e=this.serializeArray();return $.each(e,function(){t[this.name]?(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(this.value||"")):t[this.name]=this.value||""}),t},window.AddShortcodeModal=r},66024(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i,a,s=[],d=!0,c=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;d=!1}else for(;!(d=(o=i.call(n)).done)&&(s.push(o.value),s.length!==e);d=!0);}catch(t){c=!0,r=t}finally{try{if(!d&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw r}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var o={}.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?n(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=Array(e);n<e;n++)o[n]=t[n];return o}function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function r(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach(function(e){i(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function i(e,n,o){return(n=function(e){var n=function(e,n){if("object"!=t(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var r=o.call(e,n||"default");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==t(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}var a={$container:null,$content:null,$title:null,currentShortcode:null,updateTimeout:null,currentRequest:null,init:function(){this.$container=$("#vb-edit-panel"),this.$content=$("#vb-panel-content"),this.$title=$("#vb-panel-title")},render:function(t){var e=VisualBuilderState.getShortcode(t);e?(this.currentShortcode=e,this.$title.text("Edit: ".concat(e.name)),this.loadShortcodeForm(e)):this.$content.html('<p class="text-danger">Shortcode not found. ID mismatch between preview and state.</p>')},loadShortcodeForm:function(t){var e=this;if(this.currentRequest&&(this.currentRequest.abort(),this.currentRequest=null),this.$content&&0!==this.$content.length||(this.$content=$("#vb-panel-content")),0!==this.$content.length){var n=window.visualBuilderData||{},o=(n.availableShortcodes||[]).find(function(e){return e.key===t.name});if(o&&o.url){var i=o.url;"undefined"!=typeof Botble&&Botble.showLoading&&Botble.showLoading(this.$content);var a={};t.attributes&&Object.assign(a,t.attributes),t.content&&(a.content=t.content),this.currentRequest=$.ajax({url:i,method:"POST",dataType:"json",data:r({_token:n.csrfToken},a),timeout:3e4,success:function(t){if(e.currentRequest=null,"undefined"!=typeof Botble&&Botble.hideLoading(e.$content),e.$content&&0!==e.$content.length||(e.$content=$("#vb-panel-content")),t&&t.data){e.$content.html('<form id="vb-edit-form">'+t.data+"</form>");var n=e.$content;setTimeout(function(){"undefined"!=typeof Botble&&(Botble.initResources(),Botble.initMediaIntegrate(),Botble.initFieldCollapse(),"function"==typeof Botble.initCoreIcon&&Botble.initCoreIcon(),"function"==typeof Botble.initColorPicker&&Botble.initColorPicker()),document.dispatchEvent(new CustomEvent("visual-builder-form-loaded",{detail:{container:n}}))},100),e.attachEvents()}else e.$content.html('<p class="text-danger">Invalid response format.</p>')},error:function(t,n,o){if(e.currentRequest=null,"abort"!==n){"undefined"!=typeof Botble&&Botble.hideLoading(e.$content),e.$content&&0!==e.$content.length||(e.$content=$("#vb-panel-content"));var r="Failed to load shortcode form.";t.responseJSON&&t.responseJSON.message?r=t.responseJSON.message:t.responseText?r+=" "+t.status+": "+o:"timeout"===n&&(r="Request timeout. Please try again."),e.$content.html('<p class="text-danger">'+r+"</p>")}}})}else this.$content.html('<p class="text-danger">Shortcode configuration not found.</p>')}},attachEvents:function(){var t=this;this.$content.off("input change").on("input change","input, textarea, select",function(){clearTimeout(t.updateTimeout),t.updateTimeout=setTimeout(function(){t.handleFieldChange()},300)})},handleFieldChange:function(){if(this.currentShortcode){var t=this.getFormData();VisualBuilderState.updateShortcode(this.currentShortcode.id,{attributes:t.attributes,content:t.content}),"undefined"!=typeof PreviewIframe&&PreviewIframe.updateShortcode(this.currentShortcode.id,t)}},getFormData:function(){var t=$("#vb-edit-form"),n={},o="",r={};t.find('input[type="checkbox"]').each(function(){var e=$(this),n=e.attr("name");if(n){var o=n.replace("[]","");t.find('input[type="checkbox"][name="'.concat(n,'"]')).length>1&&(r[o]||(r[o]=[]),e.is(":checked")&&r[o].push(e.val()))}});for(var i=0,a=Object.entries(r);i<a.length;i++){var s=e(a[i],2),d=s[0],c=s[1];n[d]=c.join(",")}var l={};return t.find("input, textarea, select").each(function(){var e=$(this),i=e.attr("name");if("content"===e.data("shortcode-attribute"))o=e.val();else if(i){var a,s=i.replace("[]","");if(r.hasOwnProperty(s))return;if("checkbox"===e.attr("type"))a=e.is(":checked")?"yes":"no";else if("radio"===e.attr("type")){if(l[s])return;l[s]=!0;var d=t.find('input[type="radio"][name="'.concat(i,'"]:checked'));a=d.length?d.val():null}else a=e.val();Array.isArray(a)&&(a=a.join(",")),null!=a&&(n[s]=a)}}),{attributes:n,content:o}}};window.ShortcodeEditPanel=a},67241(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,n(r.key),r)}}function n(e){var n=function(e,n){if("object"!=t(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var r=o.call(e,n||"default");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==t(n)?n:n+""}var o=function(){return t=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.state=e,this.stack=[],this.pointer=-1,this.maxLength=n,this.isLocked=!1},(n=[{key:"init",value:function(t){this.stack=[JSON.parse(JSON.stringify(t))],this.pointer=0}},{key:"push",value:function(t){this.isLocked||(this.pointer<this.stack.length-1&&(this.stack=this.stack.slice(0,this.pointer+1)),this.stack.push(JSON.parse(JSON.stringify(t))),this.stack.length>this.maxLength?this.stack.shift():this.pointer++,this.state.emit("history-changed",{canUndo:this.canUndo(),canRedo:this.canRedo()}))}},{key:"undo",value:function(){if(!this.canUndo())return null;this.isLocked=!0,this.pointer--;var t=JSON.parse(JSON.stringify(this.stack[this.pointer]));return this.isLocked=!1,this.state.emit("history-changed",{canUndo:this.canUndo(),canRedo:this.canRedo()}),t}},{key:"redo",value:function(){if(!this.canRedo())return null;this.isLocked=!0,this.pointer++;var t=JSON.parse(JSON.stringify(this.stack[this.pointer]));return this.isLocked=!1,this.state.emit("history-changed",{canUndo:this.canUndo(),canRedo:this.canRedo()}),t}},{key:"canUndo",value:function(){return this.pointer>0}},{key:"canRedo",value:function(){return this.pointer<this.stack.length-1}}])&&e(t.prototype,n),o&&e(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,o}();window.HistoryManager=o},75358(){var t={inject:function(t){var e=this;if(t){this.blockLinks(t);var n=t.querySelectorAll("[data-shortcode-id]");0!==n.length&&n.forEach(function(n){e.injectIcon(n,t)})}},injectIcon:function(t,e){var n=this,o=t.getAttribute("data-shortcode-id"),r=t.getAttribute("data-shortcode-name")||"shortcode";if(!t.querySelector(":scope > .vb-shortcode-toolbar")&&!t.classList.contains("vb-shortcode-toolbar")){"static"===window.getComputedStyle(t).position&&(t.style.position="relative"),t.classList.add("vb-shortcode-block");var i=e.createElement("div");i.className="vb-shortcode-toolbar",i.setAttribute("data-shortcode-id",o);var a=e.createElement("button");a.className="vb-toolbar-btn vb-edit-btn",a.setAttribute("title","Edit ".concat(r)),a.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" /><path d="M13.5 6.5l4 4" /></svg>',a.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),n.handleEditClick(o)});var s=e.createElement("button");s.className="vb-toolbar-btn vb-delete-btn",s.setAttribute("title","Delete ".concat(r)),s.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 7l16 0" /><path d="M10 11l0 6" /><path d="M14 11l0 6" /><path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12" /><path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3" /></svg>',s.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),n.handleDeleteClick(o)}),i.appendChild(a),i.appendChild(s),t.insertBefore(i,t.firstChild)}},handleEditClick:function(t){"undefined"!=typeof ShortcodeList&&ShortcodeList.openEditPanel(t)},handleDeleteClick:function(t){"undefined"!=typeof ShortcodeList&&ShortcodeList.deleteShortcode(t)},blockLinks:function(t){t._linksBlocked||(t.addEventListener("click",function(t){t.target.closest("a")&&(t.preventDefault(),t.stopPropagation())},!0),t._linksBlocked=!0)},removeAll:function(t){t&&t.querySelectorAll(".vb-shortcode-toolbar").forEach(function(t){return t.remove()})},highlight:function(t,e){if(t&&(t.querySelectorAll(".vb-active").forEach(function(t){return t.classList.remove("vb-active")}),e)){var n=t.querySelector('[data-shortcode-id="'.concat(e,'"]'));n&&(n.classList.add("vb-active"),n.scrollIntoView({behavior:"smooth",block:"center"}))}},unhighlight:function(t){t&&t.querySelectorAll(".vb-active").forEach(function(t){return t.classList.remove("vb-active")})}};window.EditIconInjector=t},90862(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function n(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?e(Object(r),!0).forEach(function(e){o(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function o(e,n,o){return(n=function(e){var n=function(e,n){if("object"!=t(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var r=o.call(e,n||"default");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==t(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}var r={shortcodes:[],activeShortcode:null,hasChanges:!1,isSaving:!1,deviceMode:"desktop",listeners:{},init:function(t){this.shortcodes=t||[],this.activeShortcode=null,this.hasChanges=!1,this.isSaving=!1,this.deviceMode="desktop","undefined"!=typeof HistoryManager&&(this.history=new HistoryManager(this),this.history.init(this.shortcodes))},getShortcode:function(t){return this.shortcodes.find(function(e){return e.id===t})},getAllShortcodes:function(){return this.shortcodes},getActiveShortcode:function(){return this.activeShortcode?this.getShortcode(this.activeShortcode):null},updateShortcode:function(t,e){var o=this.shortcodes.findIndex(function(e){return e.id===t});-1!==o&&(this.shortcodes[o]=n(n({},this.shortcodes[o]),e),this.markChanged(),this.emit("shortcode-updated",this.shortcodes[o]),this.history&&this.history.push(this.shortcodes))},addShortcode:function(t,e){var o=n({id:this.generateId()},t);return"number"==typeof e&&e>=0&&e<=this.shortcodes.length?this.shortcodes.splice(e,0,o):this.shortcodes.push(o),this.markChanged(),this.emit("shortcode-added",o),this.history&&this.history.push(this.shortcodes),o},deleteShortcode:function(t){var e=this.shortcodes.findIndex(function(e){return e.id===t});if(-1!==e){var n=this.shortcodes.splice(e,1)[0];return this.markChanged(),this.emit("shortcode-deleted",n),this.history&&this.history.push(this.shortcodes),!0}return!1},reorderShortcodes:function(t){this.shortcodes=t,this.markChanged(),this.emit("shortcodes-reordered",t),this.history&&this.history.push(this.shortcodes)},reorderShortcodesByIds:function(t){var e=new Map(this.shortcodes.map(function(t){return[t.id,t]})),n=[];t.forEach(function(t){e.has(t)&&(n.push(e.get(t)),e.delete(t))}),e.forEach(function(t){return n.push(t)}),this.reorderShortcodes(n)},setActive:function(t){this.activeShortcode=t,this.emit("active-changed",t)},clearActive:function(){this.activeShortcode=null,this.emit("active-changed",null)},markChanged:function(){this.hasChanges||(this.hasChanges=!0,this.emit("has-changes",!0))},clearChanges:function(){this.hasChanges=!1,this.emit("has-changes",!1)},setDeviceMode:function(t){this.deviceMode=t,this.emit("device-mode-changed",t)},setSaving:function(t){this.isSaving=t,this.emit("saving-changed",t)},generateId:function(){return"sc_"+Date.now()+"_"+Math.random().toString(36).substr(2,9)},on:function(t,e){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e)},off:function(t,e){this.listeners[t]&&(this.listeners[t]=this.listeners[t].filter(function(t){return t!==e}))},emit:function(t,e){this.listeners[t]&&this.listeners[t].forEach(function(t){return t(e)})},undo:function(){if(this.history&&this.history.canUndo()){var t=this.history.undo();t&&(this.shortcodes=t,this.emit("state-restored",this.shortcodes))}},redo:function(){if(this.history&&this.history.canRedo()){var t=this.history.redo();t&&(this.shortcodes=t,this.emit("state-restored",this.shortcodes))}}};window.VisualBuilderState=r}},e={};function n(o){var r=e[o];if(void 0!==r)return r.exports;var i=e[o]={exports:{}};return t[o](i,i.exports,n),i.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";n(16620),n(75358),n(58763),n(67241),n(90862),n(45062),n(15053),n(66024),n(61696),n(51676),n(56976);$(document).ready(function(){window.visualBuilderData&&VisualBuilderApp.init()})})()})();