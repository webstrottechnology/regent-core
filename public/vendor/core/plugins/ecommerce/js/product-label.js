$(function(){if($(".box-search-advance").length){$(document).on("click",".box-search-advance .list-search-data .selectable-item",function(e){e.preventDefault();var a=$(e.currentTarget),t=a.closest(".box-search-advance"),r=t.find('input[name="label_products"]'),o=a.data("id"),c=r.val()?r.val().split(",").map(function(e){return parseInt(e.trim())}).filter(Boolean):[];if(c.includes(o))a.closest(".card").hide();else{c.push(o),r.val(c.join(","));var n=$("#selected_product_label_template").html().replace(/__id__/g,a.data("id")).replace(/__name__/g,a.data("name")).replace(/__url__/g,a.data("url")).replace(/__image__/g,a.data("image")).replace(/__attributes__/g,a.find("a span").text()||"");t.find(".list-selected-products").show().append(n),a.closest(".card").hide()}}),$(document).on("click",'[data-bb-toggle="product-search-advanced"]',function(e){var a=$(e.currentTarget),t=a.closest(".box-search-advance").find(".card");t.show().addClass("active"),0===t.find(".card-body").length&&(Botble.showLoading(t),$.ajax({url:a.data("bb-target"),type:"GET",success:function(e){e.error?Botble.showError(e.message):t.html(e.data)},error:function(e){Botble.handleError(e)},complete:function(){Botble.hideLoading(t)}}))});var e=null;$(document).on("keyup",'[data-bb-toggle="product-search-advanced"]',function(a){var t=$(a.currentTarget),r=t.closest(".box-search-advance").find(".card");clearTimeout(e),e=setTimeout(function(){Botble.showLoading(r),$.ajax({url:"".concat(t.data("bb-target"),"?keyword=").concat(t.val()),type:"GET",success:function(e){e.error?Botble.showError(e.message):r.html(e.data)},error:function(e){Botble.handleError(e)},complete:function(){Botble.hideLoading(r)}})},300)}),$(document).on("click",".box-search-advance .page-link",function(e){e.preventDefault();var a=$(e.currentTarget),t=a.closest(".box-search-advance"),r=t.find('[data-bb-toggle="product-search-advanced"]'),o=t.find(".card");a.closest(".page-item").hasClass("disabled")||(Botble.showLoading(o),$.ajax({url:"".concat(a.prop("href"),"&keyword=").concat(r.val()),type:"GET",success:function(e){e.error?Botble.showError(e.message):o.html(e.data)},error:function(e){Botble.handleError(e)},complete:function(){Botble.hideLoading(o)}}))}),$(document).on("click",function(e){$(e.target).closest(".box-search-advance").length||$(".box-search-advance .card").hide()}),$(document).on("click",'[data-bb-toggle="product-delete-item"]',function(e){e.preventDefault();var a=$(e.currentTarget),t=a.closest(".box-search-advance"),r=t.find('input[name="label_products"]'),o=a.data("bb-target"),c=r.val().split(",").map(function(e){return parseInt(e.trim())}).filter(Boolean).filter(function(e){return e!==o});r.val(c.join(","));var n=a.closest(".list-group-item"),l=n.closest(".list-group");n.remove(),0===l.find(".list-group-item").length&&t.find(".list-selected-products").hide()})}});